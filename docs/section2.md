# 단축 URL 생성 API 성능 개선하기
## 생성 API 성능 개선 방법 고민해보기
1. 오히려 커넥션 풀 숫자를 줄여서 문제가 발생하는지 확인
2. 서버 사이즈를 키워 성능이 개선되는지 확인
3. 응답과 생성을 분리하기

## 요청 처리 스레드 수 늘리기
1. 커넥션 풀에 병목이 걸린다면?

* 아무것도 튜닝하지 않은 상태
```shell
http.response_time:
  min: ............ 35
  max: ............ 265
  mean: ........... 47.4
  median: ......... 45.2
  p95: ............ 61
  p99: ............ 83.9
```

* 커넥션 풀 사이즈 1 설정
```shell
http.response_time:
  min: ............ 37
  max: ............ 1285
  mean: ........... 55.5
  median: ......... 49.9
  p95: ............ 73
  p99: ............ 156
```


## 서버 사이즈 키우기
* 기존 서버
```shell
http.response_time:
  min: ............ 35
  max: ............ 265
  mean: ........... 47.4
  median: ......... 45.2
  p95: ............ 61
  p99: ............ 83.9
```

* 더 고사양 서버
```shell
http.response_time:
  min: ............ 5
  max: ............ 193
  mean: ........... 7.6
  median: ......... 7
  p95: ............ 10.1
  p99: ............ 13.1
```

## 응답과 생성을 분리하기
비동기 + key 생성(스노우 플레이크)

* 아무것도 튜닝하지 않은 상태
```shell
http.response_time:
  min: ............ 35
  max: ............ 265
  mean: ........... 47.4
  median: ......... 45.2
  p95: ............ 61
  p99: ............ 83.9
```

* 비동기 + key 생성(스노우 플레이크) 적용
```shell
http.response_time:
  min: ............ 34
  max: ............ 202
  mean: ........... 40.3
  median: ......... 40
  p95: ............ 45.2
  p99: ............ 50.9
```

